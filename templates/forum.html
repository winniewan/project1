<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title> {{ cnitt_name }} </title>
    <link rel="stylesheet" href="{{ url_for('static', filename='forum.css') }}">
    <script type="text/javascript" src="{{ url_for('static', filename='forum.js') }}"></script>
</head>

<body>
<div class="header">
    <h1 id = "welcome" > {{ cnitt_name }} </h1>
</div>
<div class="topnav">

    <a href = "/" class = "button">Home</a>
    <a href = "{{ url_for('show_sub_cnitt')}}{{ cnitt_name }}" class = "button">{{ cnitt_name }}</a>

    {% if current_user.is_authenticated %}

        {% for sub in current_user.subscriptions %}
            {% if sub.name != cnitt_name %}
                <a href = "{{ url_for('show_sub_cnitt')}}{{ sub }}" class = "button">{{sub}}</a>
            {% endif %}

        {% endfor %}
        </div>
        <a href="/about" class = "button">About Us</a>

        <a href="{{ url_for('logout') }}" class = "button" style="float:right">Logout</a>
        <a href="{{url_for ('users', uid = current_user.id)}}" class = "button" style="float:right">Profile</a>
        <a href = "{{ url_for('mtp', cnitt_name = cnitt_name ) }}" class = "button">Create Text Post</a>
        <a href = "{{ url_for('mlp', cnitt_name = cnitt_name ) }}" class = "button">Create Link Post</a>
    {% else %}

        <a href= "/about" class = "button">About Us</a>

        <a href="{{ url_for('login') }}" class = "button" style="float:right">Login</a>
        <a href="/add_user" class = "button" style="float:right">Register</a>
        </div>
    {% endif %}

<div class="row">
    <a href = "{{ url_for('show_sub_cnitt', cnitt_name=cnitt_name, sort_type='Hot')}}" class ="button">Hot</a>
    <a href = "{{ url_for('show_sub_cnitt', cnitt_name=cnitt_name, sort_type='Top')}}" class ="button">Top</a>
    <a href = "{{ url_for('show_sub_cnitt', cnitt_name=cnitt_name, sort_type='New')}}" class ="button">New</a>

</div>

<div class="row">
    <div class="leftcolumn">
        {% for post in posts%}
            <div class="card">
                <h2><a href = "users/{{post.creator}}" > {{users.query.filter_by(id=post.creator).first().username }} </a></h2>
                <a href = "{{ url_for('show_sub_cnitt', cnitt_name=cnitt_name, sort_type='Hot')}}" class ="button">Hot</a>
                <button class="up_arrow"  type="button">UP</button>
                <b> {{ post.net_votes }}</b>
                {% if post.is_link %}
                    <h2><a href = "{{post.content}}" class="button"> {{ post.title }} </a></h2>
                {% else %}
                    <h2><a href = "{{ url_for('comments_for_post', cnitt_name = cnitt_name, post_id = post.pid)}}" class="button"> {{ post.title }} </a></h2>
                {% endif %}
                <br>
                <a href = "{{ url_for('comments_for_post', cnitt_name = cnitt_name, post_id = post.pid)}}" class="button"> comments </a>
            </div>
        {% endfor %}
    </div>
    <div class="rightcolumn">
        {% if not cnitt.required_subscription %}
            {% if current_user.is_authenticated %}
                {% if cnitt.is_subscribed(current_user) %}
                    <div class="card">
                        <a href="{{ url_for('unsubscribe', cnitt=cnitt_name) }}" class = "button">Unsubscribe</a>
                    </div>
                {% else %}
                    <div class="card">
                        <a href="{{ url_for('subscribe', cnitt=cnitt_name) }}" class = "button">Subscribe</a>
                    </div>
                {% endif %}
            {% else %}
                <div class="card">
                    <h2>Please logon to subscribe! </h2>
                </div>
            {% endif %}
        {% endif %}
        <div class="card">
            <h2>Submit a Feedback Form! </h2>
            <a href="/Feedback Form" class = "button">Feedback Form</a>
        </div>
    </div>
</div>

<div class="footer">
    <h2>Contact Us!</h2>
    <p> University of Rochester </p>
    <p> 500 Joseph C. Wilson Blvd. </p>
    <p> Rochester, NY 14627 </p>
    <p> (585) 275-2121 </p>
</div>
</body>
</html>